document.addEventListener('DOMContentLoaded', function() {
    const moodDate = document.getElementById('moodDate');
    const moodButtons = document.querySelectorAll('.mood-button');

    // Function to clear the active state from all mood buttons
    function clearActiveState() {
        moodButtons.forEach(button => button.classList.remove('active'));
    }

    // Function to set a mood button as active
    function setActiveButton(mood) {
        clearActiveState();
        const activeButton = Array.from(moodButtons).find(button => button.dataset.mood === mood);
        if (activeButton) {
            activeButton.classList.add('active');
        }
    }

    // Event listener for mood button click
    moodButtons.forEach(button => {
        button.addEventListener('click', function() {
            const mood = this.dataset.mood;
            const date = moodDate.value;
            if (!date) {
                alert("Please select a date.");
                return;
            }
            localStorage.setItem(date, mood); // Save mood in localStorage
            setActiveButton(mood); // Visually mark the button as active
        });
    });

    // Event listener for date change
    moodDate.addEventListener('change', function() {
        const selectedDate = this.value;
        const savedMood = localStorage.getItem(selectedDate);
        if (savedMood) {
            setActiveButton(savedMood); // Set the saved mood as active
        } else {
            clearActiveState(); // Clear active state if no mood saved for the date
        }
    });

    // Initialize with today's date
    moodDate.valueAsDate = new Date();
    moodDate.dispatchEvent(new Event('change'));
});
